process PROD = {
	 source = HcalTBSource {
                untracked vstring fileNames = { "file:ZDC_033593.root" }
                untracked vstring streams = { 'HCAL_Trigger','HCAL_TDC',
                    'HCAL_DCC700','HCAL_DCC701','HCAL_DCC702','HCAL_DCC703',
                    'HCAL_DCC704','HCAL_DCC705','HCAL_DCC706','HCAL_DCC707',
                    'HCAL_DCC708','HCAL_DCC709','HCAL_DCC710','HCAL_DCC711',
                    'HCAL_DCC712','HCAL_DCC713','HCAL_DCC714','HCAL_DCC715',
                    'HCAL_DCC716','HCAL_DCC717','HCAL_DCC718','HCAL_DCC719',
                    'HCAL_DCC720','HCAL_DCC721','HCAL_DCC722','HCAL_DCC723',
                    'HCAL_DCC724','HCAL_DCC725','HCAL_DCC726','HCAL_DCC727',
                    'HCAL_DCC728','HCAL_DCC729','HCAL_DCC730','HCAL_DCC731' }
        }
        untracked PSet maxEvents = {untracked int32 input = 100000}

	module unpacker = HcalRawToDigi {
                int32 firstSample = 0
                int32 lastSample = 9
                untracked int32 HcalFirstFED = 700
                untracked vint32 FEDs = { 701 }
		bool FilterDataQuality = false
		untracked bool UnpackZDC = true
                InputTag InputLabel= source 
	}

	module reco = HcalSimpleReconstructor {
	       int32 firstSample = 4
	       int32 samplesToAdd = 3
               bool correctForTimeslew = false
               bool correctForPhaseContainment = false
	       double correctionPhaseNS = 0.0
	       string Subdetector = 'ZDC'
               InputTag digiLabel = unpacker
	}

        module dumper = HcalDigiDump {
        }
        module dumper2 = HcalRecHitDump {
        }

        module tbunpacker = HcalTBObjectUnpacker {
               untracked int32 HcalTriggerFED  = 1
               untracked int32 HcalSlowDataFED = -1
               untracked int32 HcalTDCFED      = -1
               untracked int32 HcalQADCFED      = -1
               untracked int32 HcalSourcePosFED = -1
               untracked bool IncludeUnmatchedHits = false
               untracked string ConfigurationFile = 'configQADCTDC.txt'
        }

#	module out = PoolOutputModule {
#		untracked string fileName = 'Persist.root'
#	}

	es_module = HcalDbProducer {}
        es_source = HcalHardcodeCalibrations {
                untracked vstring toGet = {
                          "PedestalWidths",
                          "GainWidths", "QIEShape",
                          "channelQuality"}
        }

        es_source es_ascii = HcalTextCalibrations { VPSet input = {
                 {string object = "ElectronicsMap"
                  FileInPath file = "RecoTBCalo/ZDCTBAnalysis/test/tb2007_zdc.dat"},
                 {string object = "Pedestals"
                  FileInPath file = "RecoTBCalo/ZDCTBAnalysis/test/zdc_pedestals.txt"},
                 {string object = "Gains"
                  FileInPath file = "RecoTBCalo/ZDCTBAnalysis/test/zdc_pedestals.txt"},
                 {string object = "QIEData"
                  FileInPath file = "RecoTBCalo/ZDCTBAnalysis/test/zdc_qie.txt"}
                }
        }  

	module analysis = ZdcTBAnalyzer {
        	        PSet ZdcTBAnalyzer = {
				bool beamDetectorsADCInfoFlag = false
				bool beamDetectorsTDCInfoFlag = false
				bool wireChambersInfoFlag = false
				bool triggerInfoFlag = true
                	        string ntupleOutputFileName = "ZDC_033593.out.new.root"
                        	}
                }	

#	path p = { unpacker, dumper }
#	path p = { unpacker, dumper, reco, dumper2 }
	path p = { unpacker, tbunpacker, reco, analysis}
#	endpath op = {out}

}
